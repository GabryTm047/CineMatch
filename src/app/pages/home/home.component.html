<app-header></app-header>

<section class="home">
  <header class="hero">
    <div class="hero-text">
      <p class="eyebrow">
        Smetti di cercare,
        <span>inizia a guardare.</span>
      </p>
      <div class="buttons">
        <button type="button" class="primary" (click)="startQuiz()">Inizia il quiz</button>
        <button type="button" class="ghost" (click)="goToStatistics()">Statistiche</button>
      </div>
      @if (user()?.isGuest) {
      <p class="guest-hint">
        Stai esplorando come ospite. Registrati per salvare i risultati in seguito
      </p>
      }
    </div>
  </header>
  @if (movieItems().length) {
  <section class="movies">
    <h2>Film consigliati in base alle statistiche</h2>
    <div class="carousel">
      <div class="nav prev" (click)="prevSlide()" aria-label="Precedente">
        <i class="fa-solid fa-circle-left"></i>
      </div>
      <div class="viewport">
        <ng-container *ngIf="currentMovie() as m">
          <div class="slide">
            @if (m.poster_path) {
            <div>
              <img [src]="'https://image.tmdb.org/t/p/w342' + m.poster_path" [alt]="m.title" />
            </div>
            }@else {
            <div>
              <div class="no-image">Nessuna immagine disponibile</div>
            </div>
            }
            <div class="movie-details">
              <h3>{{ m.title }}</h3>
              <p class="overview">{{ m.overview }}</p>
              <p class="rating"><strong>Voto:</strong> {{ m.vote_average }}</p>
            </div>
          </div>
        </ng-container>
      </div>
      <div class="nav next" (click)="nextSlide()" aria-label="Successivo">
        <i class="fa-solid fa-circle-right"></i>
      </div>
    </div>
    <div class="carousel-toolbar">
      @if((movies()?.page ?? 1) > 1){ }
      <button type="button" class="to-start" (click)="goToStart()">Torna all'inizio</button>
      <div class="counts">
        <span>Pagina {{ movies()?.page ?? 1 }} di {{ movies()?.total_pages ?? 0 }}</span>
      </div>
    </div>
    <div class="dots">
      @for (i of dots(); track $index) {
      <span class="dot" [class.active]="$index === currentIndex() % 20"></span>
      }
    </div>
  </section>
  } @else {
  <div>
    <div class="loading-state">Caricamento film…</div>
  </div>
  }
  <header class="hero">
    <div class="hero-text">
      <h1>Scopri il mix perfetto di generi per la tua prossima visione</h1>
      <p class="lead">
        Rispondi a 10 domande mirate sui tuoi gusti attuali: CineMatch ti dira i generi che ami di
        più in base il mood attuale.
      </p>
    </div>
    <div class="hero-card">
      <div class="card-title">Come funziona?</div>
      <ul>
        <li>
          <span class="badge">1</span>
          Rispondi a domande rapide sui tuoi interessi
        </li>
        <li>
          <span class="badge">2</span>
          Scopri i tuoi gusti tramite un grafico a torta
        </li>
        <li>
          <span class="badge">3</span>
          Scegli il film che matcha di più con te stasera
        </li>
      </ul>
    </div>
  </header>

  <section class="highlights">
    <article>
      <h2>Domande studiate dai nostri esperti</h2>
      <p>
        Ogni risposta associa emozioni, ritmo e atmosfere ai corrispondenti generi cinematografici.
        In meno di cinque minuti ottieni un profilo accurato dei tuoi gusti.
      </p>
    </article>
    <article>
      <h2>Grafico finale immediato</h2>
      <p>
        Visualizza le percentuali in un grafico a torta elegante e condivisibile, ideale per
        decidere rapidamente cosa guardare con amici o famiglia.
      </p>
    </article>
    <article>
      <h2>Risultati sempre aggiornati</h2>
      <p>
        Puoi rifare il test ogni volta che vuoi: CineMatch aggiorna il tuo profilo in base al
        momento e all'umore della serata.
      </p>
    </article>
  </section>
</section>
